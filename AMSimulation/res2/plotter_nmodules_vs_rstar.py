import matplotlib.pyplot as plt
import numpy as np

# Run 0, scanning R*, using R_z* = 110
res_20160507_0 = \
"""0.0 28552
20.0 26178
21.0 26122
22.0 26070
23.0 26014
24.0 25898
25.0 25834
26.0 25834
27.0 25776
28.0 25652
29.0 25528
30.0 25448
31.0 25448
32.0 25320
33.0 25160
34.0 25160
35.0 24870
36.0 24528
37.0 24416
38.0 24364
39.0 24172
40.0 24172
41.0 24172
42.0 24172
43.0 24172
44.0 24048
45.0 23938
46.0 23882
47.0 23434
48.0 23434
49.0 23434
50.0 23230
51.0 23230
52.0 23122
53.0 23064
54.0 23064
55.0 23008
56.0 23008
57.0 22816
58.0 22816
59.0 22736
60.0 22640
61.0 22640
62.0 22614
63.0 22586
64.0 22572
65.0 22586
66.0 22478
67.0 22334
68.0 22402
69.0 22312
70.0 22424
71.0 22366
72.0 22402
73.0 22374
74.0 22342
75.0 22342
76.0 22310
77.0 22310
78.0 22726
79.0 22906
80.0 22792
81.0 22878
82.0 23188
83.0 23348
84.0 23704
85.0 23774
86.0 23774
87.0 23774
88.0 23886
89.0 23886
90.0 24526
91.0 24526
92.0 25422
93.0 25590
94.0 25346
95.0 25238
96.0 25266
97.0 25526
98.0 25592
99.0 25648
100.0 25716
101.0 25818
102.0 25882
103.0 26074
104.0 26074
105.0 26102
106.0 26196
107.0 26224
108.0 26252
109.0 26252
110.0 26252
"""

# Run 1, scanning R_z*, using R* = 76.5, determined in Run 0
res_20160507_1 = \
"""10.0 35060
20.0 27824
21.0 27388
22.0 26834
23.0 26306
24.0 25936
25.0 25738
26.0 25420
27.0 25294
28.0 25088
29.0 24656
30.0 24484
31.0 24276
32.0 24182
33.0 23932
34.0 23830
35.0 23768
36.0 23634
37.0 23652
38.0 23566
39.0 23364
40.0 23214
41.0 23194
42.0 23162
43.0 23072
44.0 22972
45.0 22840
46.0 22666
47.0 22342
48.0 22266
49.0 22204
50.0 22180
51.0 22208
52.0 22208
53.0 22116
54.0 22124
55.0 22128
56.0 22152
57.0 22208
58.0 22240
59.0 22288
60.0 22224
61.0 22202
62.0 22258
63.0 22258
64.0 22226
65.0 22226
66.0 22226
67.0 22188
68.0 22188
69.0 22188
70.0 22188
71.0 22238
72.0 22238
73.0 22270
74.0 22270
75.0 22214
76.0 22246
77.0 22246
78.0 22194
79.0 22156
80.0 22156
81.0 22236
82.0 22260
83.0 22222
84.0 22194
85.0 22156
86.0 22180
87.0 22180
88.0 22204
89.0 22228
90.0 22228
91.0 22228
92.0 22228
93.0 22228
94.0 22266
95.0 22282
96.0 22284
97.0 22284
98.0 22284
99.0 22284
100.0 22346
101.0 22318
102.0 22318
103.0 22266
104.0 22266
105.0 22238
106.0 22262
107.0 22262
108.0 22262
109.0 22262
110.0 22310
"""

# Run 2, scanning R* again, using R_z* = 53, as determined in Run 1
res_20160507_2 = \
"""0.0 28614
20.0 26212
21.0 26148
22.0 26088
23.0 26028
24.0 25920
25.0 25856
26.0 25856
27.0 25796
28.0 25670
29.0 25544
30.0 25456
31.0 25456
32.0 25328
33.0 25168
34.0 25168
35.0 24886
36.0 24550
37.0 24430
38.0 24370
39.0 24178
40.0 24178
41.0 24178
42.0 24178
43.0 24178
44.0 24052
45.0 23934
46.0 23874
47.0 23426
48.0 23426
49.0 23426
50.0 23206
51.0 23206
52.0 23086
53.0 23026
54.0 23026
55.0 22966
56.0 22966
57.0 22774
58.0 22774
59.0 22686
60.0 22590
61.0 22590
62.0 22562
63.0 22532
64.0 22498
65.0 22500
66.0 22380
67.0 22220
68.0 22280
69.0 22148
70.0 22260
71.0 22200
72.0 22218
73.0 22188
74.0 22148
75.0 22148
76.0 22116
77.0 22116
78.0 22516
79.0 22664
80.0 22544
81.0 22610
82.0 22898
83.0 23058
84.0 23374
85.0 23434
86.0 23434
87.0 23434
88.0 23538
89.0 23538
90.0 24146
91.0 24146
92.0 25010
93.0 25170
94.0 24918
95.0 24798
96.0 24828
97.0 25110
98.0 25172
99.0 25232
100.0 25292
101.0 25384
102.0 25432
103.0 25624
104.0 25624
105.0 25654
106.0 25748
107.0 25778
108.0 25808
109.0 25808
110.0 25808
"""

# Run 3, scanning R*, but define the overlap area using a 2 GeV track and
# a straight track, using R_z* = 53. This result is wrong
res_20160507_3 = \
"""0.0 27304
10.0 26088
20.0 25028
25.0 24700
30.0 24320
31.0 24320
32.0 24192
33.0 24032
34.0 24032
35.0 23784
36.0 23468
37.0 23358
38.0 23306
39.0 23114
40.0 23114
41.0 23114
42.0 23114
43.0 23114
44.0 22990
45.0 22884
46.0 22830
47.0 22398
48.0 22398
49.0 22398
50.0 22194
51.0 22194
52.0 22086
53.0 21972
54.0 21972
55.0 21918
56.0 21918
57.0 21726
58.0 21726
59.0 21646
60.0 21550
61.0 21550
62.0 21496
63.0 21468
64.0 21386
65.0 21334
66.0 21226
67.0 21034
68.0 21034
69.0 20874
70.0 20874
71.0 20820
72.0 20792
73.0 20766
74.0 20686
75.0 20686
76.0 20590
77.0 20590
78.0 20590
79.0 20482
80.0 20372
81.0 20292
82.0 20266
83.0 20266
84.0 20266
85.0 20266
86.0 20266
87.0 20266
88.0 20186
89.0 20186
90.0 20186
91.0 20186
92.0 20186
93.0 20130
94.0 19886
95.0 19778
96.0 19778
97.0 19778
98.0 19778
99.0 19778
100.0 19778
101.0 19778
102.0 19778
103.0 19778
104.0 19778
105.0 19778
106.0 19778
107.0 19778
108.0 19778
109.0 19778
110.0 19778
"""

# Run 4, scanning R_z*, now using a beamspot of 15 cm
res_20160507_4 = \
"""20.0 33478
21.0 32934
22.0 32416
23.0 31808
24.0 31362
25.0 30928
26.0 30392
27.0 29990
28.0 29584
29.0 29142
30.0 28530
31.0 28230
32.0 27940
33.0 27774
34.0 27472
35.0 27024
36.0 26750
37.0 26502
38.0 26190
39.0 25866
40.0 25530
41.0 25508
42.0 25252
43.0 25166
44.0 24956
45.0 24880
46.0 24908
47.0 24736
48.0 24560
49.0 24390
50.0 24186
51.0 24170
52.0 24082
53.0 24114
54.0 24118
55.0 24142
56.0 24160
57.0 24018
58.0 24162
59.0 24048
60.0 24096
61.0 24036
62.0 23998
63.0 24086
64.0 23966
65.0 23948
66.0 23864
67.0 23664
68.0 23744
69.0 23628
70.0 23644
71.0 23592
72.0 23524
73.0 23524
74.0 23518
75.0 23506
76.0 23530
77.0 23498
78.0 23492
79.0 23454
80.0 23558
81.0 23558
82.0 23558
83.0 23606
84.0 23584
85.0 23608
86.0 23602
87.0 23602
88.0 23564
89.0 23612
90.0 23612
91.0 23662
92.0 23694
93.0 23724
94.0 23802
95.0 23814
96.0 23934
97.0 23934
98.0 23934
99.0 24004
100.0 24060
101.0 24124
102.0 24072
103.0 24096
104.0 24096
105.0 24076
106.0 24076
107.0 23972
108.0 24010
109.0 24058
110.0 24082
"""

# Run 1, scanning R_z*, 7cm beam spot, after bug fix
res_20160509_1 = \
"""10.0 37744
20.0 27824
25.0 25738
30.0 24484
31.0 24276
32.0 24182
33.0 23932
34.0 23830
35.0 23768
36.0 23634
37.0 23652
38.0 23566
39.0 23364
40.0 23214
41.0 23194
42.0 23162
43.0 23072
44.0 22972
45.0 22840
46.0 22666
47.0 22342
48.0 22266
49.0 22204
50.0 22180
51.0 22208
52.0 22208
53.0 22116
54.0 22124
55.0 22128
56.0 22152
57.0 22208
58.0 22240
59.0 22288
60.0 22224
61.0 22202
62.0 22258
63.0 22258
64.0 22226
65.0 22226
66.0 22226
67.0 22188
68.0 22188
69.0 22188
70.0 22188
71.0 22238
72.0 22238
73.0 22270
74.0 22270
75.0 22214
76.0 22246
77.0 22246
78.0 22194
79.0 22156
80.0 22156
81.0 22236
82.0 22260
83.0 22222
84.0 22194
85.0 22156
86.0 22180
87.0 22180
88.0 22204
89.0 22228
90.0 22228
91.0 22228
92.0 22228
93.0 22228
94.0 22266
95.0 22282
96.0 22284
97.0 22284
98.0 22284
99.0 22284
100.0 22346
101.0 22318
102.0 22318
103.0 22266
104.0 22266
105.0 22238
106.0 22262
107.0 22262
108.0 22262
109.0 22262
110.0 22310
"""

# Run 2, scanning R_z*, 15cm beam spot, after bug fix
res_20160509_2 = \
"""10.0 55136
20.0 35386
25.0 31292
30.0 28530
31.0 28230
32.0 27940
33.0 27774
34.0 27472
35.0 27024
36.0 26750
37.0 26502
38.0 26190
39.0 25866
40.0 25530
41.0 25508
42.0 25252
43.0 25166
44.0 24956
45.0 24880
46.0 24908
47.0 24736
48.0 24560
49.0 24390
50.0 24186
51.0 24170
52.0 24082
53.0 24114
54.0 24118
55.0 24142
56.0 24160
57.0 24018
58.0 24162
59.0 24048
60.0 24096
61.0 24036
62.0 23998
63.0 24086
64.0 23966
65.0 23948
66.0 23864
67.0 23664
68.0 23744
69.0 23628
70.0 23644
71.0 23592
72.0 23524
73.0 23524
74.0 23518
75.0 23506
76.0 23530
77.0 23498
78.0 23492
79.0 23454
80.0 23558
81.0 23558
82.0 23558
83.0 23606
84.0 23584
85.0 23608
86.0 23602
87.0 23602
88.0 23564
89.0 23612
90.0 23612
91.0 23662
92.0 23694
93.0 23756
94.0 23834
95.0 23846
96.0 23966
97.0 23966
98.0 23966
99.0 24036
100.0 24092
101.0 24156
102.0 24104
103.0 24128
104.0 24128
105.0 24108
106.0 24108
107.0 24004
108.0 24042
109.0 24090
110.0 24114
"""

# Run 3, scanning R_z*, 25cm beam spot, after bug fix
res_20160509_3 = \
"""10.0 71280
20.0 44688
25.0 37942
30.0 33644
31.0 33160
32.0 32860
33.0 32224
34.0 31482
35.0 30838
36.0 30456
37.0 30142
38.0 29632
39.0 29410
40.0 28986
41.0 28766
42.0 28542
43.0 28216
44.0 27890
45.0 27776
46.0 27504
47.0 27362
48.0 26998
49.0 26686
50.0 26346
51.0 26282
52.0 26056
53.0 26060
54.0 26124
55.0 26086
56.0 26064
57.0 26080
58.0 26036
59.0 26064
60.0 26062
61.0 25902
62.0 25762
63.0 25790
64.0 25666
65.0 25682
66.0 25498
67.0 25578
68.0 25540
69.0 25548
70.0 25532
71.0 25590
72.0 25562
73.0 25572
74.0 25496
75.0 25496
76.0 25444
77.0 25316
78.0 25224
79.0 25270
80.0 25242
81.0 25190
82.0 25174
83.0 25066
84.0 25130
85.0 25246
86.0 25272
87.0 25290
88.0 25330
89.0 25292
90.0 25330
91.0 25424
92.0 25494
93.0 25542
94.0 25692
95.0 25708
96.0 25732
97.0 25760
98.0 25784
99.0 25784
100.0 25770
101.0 25826
102.0 25914
103.0 26008
104.0 26056
105.0 26004
106.0 25952
107.0 25952
108.0 25912
109.0 25964
110.0 25996
"""

# Run 4, scanning R*, 7cm beamspot, R_z* = 53cm
res_20160509_4 = \
"""0.0 28614
10.0 27298
20.0 26212
25.0 25856
30.0 25456
31.0 25456
32.0 25328
33.0 25168
34.0 25168
35.0 24886
36.0 24550
37.0 24430
38.0 24370
39.0 24178
40.0 24178
41.0 24178
42.0 24178
43.0 24178
44.0 24052
45.0 23934
46.0 23874
47.0 23426
48.0 23426
49.0 23426
50.0 23206
51.0 23206
52.0 23086
53.0 23026
54.0 23026
55.0 22966
56.0 22966
57.0 22774
58.0 22774
59.0 22686
60.0 22590
61.0 22590
62.0 22562
63.0 22532
64.0 22498
65.0 22500
66.0 22380
67.0 22220
68.0 22280
69.0 22148
70.0 22260
71.0 22200
72.0 22218
73.0 22188
74.0 22148
75.0 22148
76.0 22116
77.0 22116
78.0 22516
79.0 22664
80.0 22544
81.0 22610
82.0 22898
83.0 23058
84.0 23374
85.0 23434
86.0 23434
87.0 23434
88.0 23538
89.0 23538
90.0 24146
91.0 24146
92.0 25010
93.0 25170
94.0 24918
95.0 24798
96.0 24828
97.0 25110
98.0 25172
99.0 25232
100.0 25292
101.0 25384
102.0 25432
103.0 25624
104.0 25624
105.0 25654
106.0 25748
107.0 25778
108.0 25808
109.0 25808
110.0 25808
"""

# Run 5, scanning R*, 15cm beamspot, R_z* = 79cm
res_20160509_5 = \
"""0.0 29800
10.0 28486
20.0 27370
25.0 27002
30.0 26616
31.0 26616
32.0 26488
33.0 26328
34.0 26328
35.0 26066
36.0 25700
37.0 25584
38.0 25524
39.0 25332
40.0 25332
41.0 25332
42.0 25332
43.0 25332
44.0 25208
45.0 25098
46.0 25042
47.0 24594
48.0 24594
49.0 24594
50.0 24378
51.0 24378
52.0 24258
53.0 24200
54.0 24200
55.0 24144
56.0 24144
57.0 23952
58.0 23952
59.0 23872
60.0 23776
61.0 23776
62.0 23750
63.0 23722
64.0 23708
65.0 23722
66.0 23602
67.0 23474
68.0 23546
69.0 23456
70.0 23568
71.0 23510
72.0 23546
73.0 23518
74.0 23486
75.0 23486
76.0 23454
77.0 23454
78.0 23902
79.0 24102
80.0 23984
81.0 24066
82.0 24432
83.0 24592
84.0 24984
85.0 25054
86.0 25054
87.0 25054
88.0 25166
89.0 25166
90.0 25902
91.0 25902
92.0 26894
93.0 27058
94.0 26806
95.0 26686
96.0 26714
97.0 26978
98.0 27052
99.0 27108
100.0 27180
101.0 27282
102.0 27346
103.0 27538
104.0 27538
105.0 27566
106.0 27660
107.0 27688
108.0 27716
109.0 27716
110.0 27716
"""


# Pick the result
res = res_20160509_4

xx, yy = [], []
for line in res.splitlines():
    values = line.split()
    assert(len(values) == 2)
    xx.append(float(values[0]))
    yy.append(float(values[1]))

minimum = 999999
minimum_x = 0
for x, y in zip(xx, yy):
    if minimum > y:
        minimum = y
        minimum_x = x
assert(minimum_x > 0)

plt.plot(xx, yy)
plt.xlabel(r'$R^*$ [cm]', fontsize=16)
plt.ylabel(r'Number of modules', fontsize=16)
plt.text(60, 27000, r'Min num of modules = %i' % minimum, fontsize=14)
plt.text(60, 26500, r'at $R^*$ = %i cm' % minimum_x, fontsize=14)
plt.grid(True)

plt.savefig('nmodules_vs_rstar.png')
#plt.show()


